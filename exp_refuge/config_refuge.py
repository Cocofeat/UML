# -*- coding: utf-8 -*-
# @Time    : 2023/3/22 15:45
# @Author  : Karry Ren

""" Config file. Set all hyperparameters for Refuge Dataset. """

# ************************************************************************************ #
# ************************************ GPU SETTINGS ********************************** #
# ************************************************************************************ #
GPU_ID = "1, 2"  # The VISIBLE_DEVICES

# ************************************************************************************ #
# ****************************** DIRECTORY PATH SETTINGS ***************************** #
# ************************************************************************************ #
PATH_SAVE = "save/"
PATH_CHECKPOINTS = f"{PATH_SAVE}/checkpoints/"
PATH_LOGFILE = f"{PATH_SAVE}/logs/"
PATH_MODEL = f"{PATH_CHECKPOINTS}/Model_results/"

# ************************************************************************************ #
# ********************************** DATASET SETTINGS ******************************** #
# ************************************************************************************ #
REFUGE_ROOT_PATH = "/Users/karry/KarryRen/Scientific-Projects/2023-UML/Code/Data/Refuge/Refuge_Dataset"
BATCH_SIZE = 8

# ************************************************************************************ #
# *********************************** MODEL SETTINGS ********************************* #
# ************************************************************************************ #
# for model structure
PRETRAINED_RES2NET_PATH = ("/Users/karry/KarryRen/Scientific-Projects/2023-UML/Code/UML/models/"
                           "model_lib/pretrained_model_zoo/res2net50_v1b_26w_4s-3cf99910.pth")
SEG_CLASS = 3
CLS_CLASS = 2
# for optimizer
LEARNING_RATE = 0.0001
WEIGHT_DECAY = 1e-5

# ************************************************************************************ #
# ********************************** TRAINING SETTINGS ******************************* #
# ************************************************************************************ #
EPOCH = 100
TRAIN_NUM = 400
# steps
WHOLE_STEPS = (TRAIN_NUM / BATCH_SIZE) * EPOCH
CHANGE_EPOCH = 30
POWER = 0.9
BASE_STEPS = (TRAIN_NUM / BATCH_SIZE) * CHANGE_EPOCH - 1
# loss
CLS_ANNEALING_EPOCH = 50
SEG_ANNEALING_EPOCH = 50
# loss weight
CLS_LOSS_WEIGHT = 0.5
MUT_LOSS_WEIGHT = 0.1
SEG_LOSS_WEIGHT = 0.4

# ************************************************************************************ #
# ********************************** VALID SETTINGS ********************************** #
# ************************************************************************************ #
VALID_EPOCH = 80

# ************************************************************************************ #
# ********************************** OTHER SETTINGS ********************************** #
# ************************************************************************************ #
COLOR = ["red", "green", "blue", "black", "yellow", "orange", "purple", "pink", "peru"]
